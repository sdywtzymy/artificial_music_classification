# Artificial Music Genre

An artificial music genre with CRNN.

This project is for ECE544 (2018 Fall) course in UIUC.

## Dependencies
* Librosa
* Keras, with version >= 2.0
* Tensorflow, with version >= 1.4

Notice: this project uses Keras with Tensorflow backend. Though we try to set parameters' dimensions to fit both two backends, you may meet errors if you are using Theano as backend.

## Prerequisites
If you want to run files in '/trainer', you need [Google Cloud](https://cloud.google.com)

## Files summary
* Folder '/data': This folder contains the stored model 'crnn_model.h5', some test songs, and the mel-grams data generated by these songs.
* Folder '/img': This folder contains the images needed by this readme.
* Folder '/trainer' : This folder is for Google Cloud trainning, along with file 'config.yaml' and 'setup.py'.
* file 'music_preProcess.py': Convert a song into its paticular mel-gram spectrum. 
* file 'generateData.py': Crate trainning data.
* file 'crnn_model.py': The CRNN model.
* file 'model_train.py' : Model trainning.
* file 'example_music_tag.py': Use our model to predict.

## Model Trainning
You can train this model on Google Cloud or your local machine.
### on Google Cloud
'''
PROJECT="YOUR_PROJECT_NAME"
BUCKET="gs://${PROJECT}"
JOB_NAME="YOUR_JOB_NAME"
PATH="PROJECT_LOCAL_PATH"
gcloud ml-engine jobs submit training ${JOB_NAME} \
--package-path ${PATH}/artificial_music_classification/trainer \
--module-name trainer.task \
--staging-bucket ${BUCKET} \
--runtime-version=1.6 \
--python-version=3.5 \
--region us-central1 \
--config ${PATH}/artificial_music_classification/config.yaml \
-- \
--train_data_paths gs://ymy_ece544/ttt.txt
'''

## Preprocessing

## Model
![CRNN](https://github.com/sdywtzymy/artificial_music_classification/blob/master/img/crnn.png "CRNN model")
